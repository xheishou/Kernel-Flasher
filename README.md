# Android Kernel Flasher

这个Android应用程序是为了帮助用户更容易地刷写内核（Kernel）到他们的设备上。它提供了一个简单的界面，允许用户选择一个内核文件（可以是压缩包或者单个文件），然后应用会自动处理刷写过程。该程序主要面向有一定Android系统知识和对设备刷机有需求的用户。

## 主要功能

- **权限请求**：应用启动时会检查是否已获得读取外部存储的权限，如果没有，则会请求用户授权。这一步是必需的，因为应用需要读取用户选择的内核文件。
- **文件选择**：用户可以通过点击界面上的按钮来打开文件选择器，从中选择一个内核文件。应用支持选择任意类型的文件，但只有特定格式的文件（如.zip压缩包或特定的内核文件）才会被正确处理。
- **内核刷写**：应用会根据选择的文件类型进行不同的处理。如果是.zip压缩包，会先解压，然后寻找压缩包内的`anykernel.sh`脚本和内核镜像文件（`Image.gz-dtb`或`Image.gz`）。找到后，应用将执行`anykernel.sh`脚本来刷写内核。
- **反馈**：刷写过程完成后，应用会给用户反馈操作的结果，无论成功或失败。

## 详细实现

### 权限处理

在`MainActivity`的`onCreate`方法中，会检查应用是否有读取外部存储的权限。如果没有，会请求用户授权。

### 文件选择

当用户点击界面上的按钮时，如果已经有了读取外部存储的权限，应用会打开文件选择器，允许用户选择任意类型的文件。这是通过发送一个`ACTION_GET_CONTENT`意图来实现的，它允许用户选择特定类型的数据并返回。

### 内核刷写

选择文件后，应用会调用`flashKernel`方法来处理刷写逻辑。该方法首先尝试打开选中的文件。如果文件是一个.zip压缩包，应用会解压它并寻找必需的脚本和内核镜像文件。找到所需文件后，应用会使用`su`命令执行`anykernel.sh`脚本来刷写内核。

### 反馈

无论刷写成功还是失败，应用都会通过`Toast`消息给用户反馈。如果刷写成功，会显示“Kernel flashed successfully!”；如果失败，会显示错误信息。

## 注意事项

- 该应用需要设备已经获得Root权限，因为刷写内核的过程需要执行具有Root权限的命令。
- 应用在处理文件和执行刷写操作时，会在设备上创建临时文件。刷写完成后，这些临时文件会被清理。
- 用户在使用该应用刷写内核时应谨慎，因为不正确的操作可能会导致设备无法启动。

## 结语

这个Android Kernel Flasher应用提供了一个简单直观的方式来刷写设备的内核。它旨在帮助那些希望自定义自己设备的高级用户，通过自动化处理刷写流程，降低了操作的复杂度。然而，使用该应用需要一定的知识储备，并且用户应该对可能的风险有所了解。